{"ts":1359868860562,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"!!!5\r\nhtml \r\n    title Inventory Update\r\n    link(rel='stylesheet', href='/stylesheets/style.css')\r\n    script(src='/js/jquery-1.9.0.min.js')\r\n    script(src='/js/jquery.mask.min.js')\r\n    script\r\n        $(document).ready(function() {\r\n          //$('#od_sphere').mask('99999.99');\r\n          $('#type').change(function() {\r\n                if($(this).val() == \"S\")\r\n                {\r\n                    alert(\"Single\");\r\n                    $(\"#od_add\").attr(\"disabled\",\"disabled\");\r\n                    $(\"#os_add\").attr(\"disabled\",\"disabled\");\r\n                }\r\n                else\r\n                {\r\n                    $(\"#od_add\").removeAttr(\"disabled\");\r\n                    $(\"#os_add\").removeAttr(\"disabled\");\r\n                }\r\n            });\r\n\r\n         $(\"#od_axis,#os_axis\").blur(function(){\r\n                formatDegrees($(this));\r\n            });\r\n\r\n         $(\"#od_sphere,#os_sphere\").blur(function(){\r\n                formatQuarters($(this));\r\n            });   \r\n        \r\n        $(\"#od_cylinder,#os_cylinder\").blur(function(){\r\n                var obj = $(this);\r\n                formatQuarters(obj);\r\n                if(parseFloat(obj.val()) > 0)\r\n                   obj.val(\"-\" + obj.val()); //always negative\r\n            });   \r\n        });\r\n\r\n        function isNumber(n) {\r\n          return !isNaN(parseFloat(n)) && isFinite(n);\r\n        }\r\n        \r\n        function formatDegrees(obj)\r\n        {\r\n            var orig_val = obj.val();\r\n            if(!isNumber(orig_val))\r\n            {\r\n                obj.parent().removeClass(\"value_adjusted\").attr(\"title\",\"\");\r\n                return;\r\n            }\r\n\r\n            var calc_val = Math.abs(Math.floor(orig_val));\r\n            \r\n            if( parseFloat(calc_val) == 180)\r\n            {\r\n                calc_val = 0;\r\n            }\r\n            obj.val(calc_val);\r\n            markAdjusted(obj, orig_val, calc_val);\r\n        }\r\n            \r\n        function formatQuarters(obj)\r\n        {\r\n            var orig_val= obj.val();\r\n            if(!isNumber(orig_val))\r\n            {\r\n                obj.parent().removeClass(\"value_adjusted\").attr(\"title\",\"\");\r\n                return;\r\n            }\r\n            var cal_val;\r\n            var val_floor = Math.floor(orig_val);\r\n            var val_abs =  Math.abs(orig_val);\r\n            var val_dec = val_abs - val_floor;\r\n            val_dec = Math.round(val_dec*100)/100;\r\n            var val_mod =  (val_abs-val_floor)%0.25;\r\n            val_mod = Math.round(val_mod*100)/100;\r\n            var val_diff = 0.25-val_mod;\r\n            val_diff = Math.round(val_diff*100)/100;\r\n            \r\n            \r\n            \r\n            /*if(parseFloat(val_dec) == 0)\r\n            {\r\n                obj.val(val_floor + \".00\");\r\n                return;\r\n            }*/\r\n            \r\n            if(val_mod >= 0.13)\r\n            {\r\n                if(orig_val>=0)\r\n                    cal_val = parseFloat(orig_val) + parseFloat(val_diff);\r\n                else\r\n                    cal_val = parseFloat(orig_val) - parseFloat(val_diff);\r\n            }\r\n            else\r\n            {\r\n                if(orig_val>=0)\r\n                    cal_val = parseFloat(orig_val) - parseFloat(val_mod);\r\n                else\r\n                    cal_val = parseFloat(orig_val) + parseFloat(val_mod);\r\n            }\r\n              \r\n    \r\n            cal_val = Math.round(cal_val*100)/100;\r\n            var dec = Math.abs(cal_val)- Math.abs(Math.floor(cal_val));\r\n        /*\r\n            $(\"#debug\").html(null);\r\n            $(\"#debug\").html($(\"#debug\").html()+ \"<br>orig:\" + orig_val);\r\n            $(\"#debug\").html($(\"#debug\").html()+ \"<br>Math.abs:\" + val_abs);\r\n            $(\"#debug\").html($(\"#debug\").html()+ \"<br>Math.floor:\" + val_floor);\r\n            $(\"#debug\").html($(\"#debug\").html()+ \"<br>Abs-Floor:\" + val_dec);\r\n            $(\"#debug\").html($(\"#debug\").html()+ \"<br>Mod:\" + val_mod );\r\n            $(\"#debug\").html($(\"#debug\").html()+ \"<br>diff:\" + val_diff );\r\n            $(\"#debug\").html($(\"#debug\").html()+ \"<br>Calculated:\" + cal_val );\r\n            $(\"#debug\").html($(\"#debug\").html()+ \"<br>Calc Dec:\" + Math.abs(cal_val) +\"-\"+ Math.floor(cal_val) + \"=\" + dec);\r\n        */    \r\n            if(parseFloat(dec) == 0)\r\n                cal_val = cal_val + \".00\";\r\n            obj.val(cal_val).attr(\"ov\",orig_val);\r\n            \r\n            markAdjusted(obj, orig_val, cal_val);\r\n        }\r\n    \r\n        function markAdjusted(obj, orig_val, cal_val)\r\n        {\r\n            if(cal_val != orig_val)\r\n            {\r\n                obj.parent().addClass(\"value_adjusted\").attr(\"title\",\"Adjusted Value, Original: \" + orig_val);\r\n            }\r\n            else\r\n            {\r\n                if(obj.val() == obj.attr(\"ov\"))\r\n                    obj.parent().removeClass(\"value_adjusted\").attr(\"title\",\"\");\r\n            }\r\n        }\r\n\r\n        function validate()\r\n        {\r\n            var valid = true;\r\n            $(\".error :first-child\").each(function(){\r\n                $(this).unwrap();\r\n            });\r\n            if($(\"#type\").val() == \"\")\r\n            {\r\n                valid = false;\r\n                $(\"#type\").wrap(\"<div class=\\\"error\\\">Required Field</div>\");\r\n            }\r\n            var odshere_v = $(\"od_sphere\").val();\r\n            \r\n\r\n            return valid;\r\n        }\r\nbody\r\n  h1 Inventory Update\r\n  span.explations The inventory number will be automatically generated\r\n\r\n  div(class=\"centered\")\r\n      form#locations(method=\"post\",action='/inventory')\r\n        table(class=\"centered\")\r\n            tbody\r\n                tr(title=\"Inventory Number\") \r\n                    th SKU\r\n                    td \r\n                        input(id=\"sku\",type=\"text\", name=\"sku\", /*disabled=\"disabled\",*/value=\"12345\")\r\n                tr(title=\"Type\") \r\n                    th Type\r\n                    td \r\n                        select(id=\"type\",name=\"type\", tabindex=\"1\")\r\n                            option(value=\"\")\r\n                            option(value=\"S\") Single                        \r\n                            option(value=\"B\", selected=true) Bifocal\r\n                tr(title=\"Gender\") \r\n                    th Gender\r\n                    td \r\n                        select(name=\"gender\",tabindex=\"2\")\r\n                            option(value=\"\")\r\n                            option(value=\"M\") Male                        \r\n                            option(value=\"M\") Female                        \r\n                            option(value=\"U\", selected=true) Unisex\r\n                tr(title=\"Size\") \r\n                    th Size\r\n                    td \r\n                         select(name=\"size\",tabindex=\"3\")\r\n                            option(value=\"\")\r\n                            option(value=\"C\") Child\r\n                            option(value=\"S\") Small                     \r\n                            option(value=\"M\", selected=true) Medium\r\n                            option(value=\"L\") Large\r\n                tr(title=\"Tint\") \r\n                    th Tint\r\n                    td \r\n                         select(name=\"tint\",tabindex=\"4\")\r\n                            option(value=\"\")\r\n                            option(value=\"N\", selected=true) No\r\n                            option(value=\"D\") Dark\r\n                            option(value=\"L\") Light\r\n                tr(title=\"Material\") \r\n                    th Material\r\n                    td \r\n                         select(name=\"material\",tabindex=\"5\")\r\n                            option(value=\"\")\r\n                            option(value=\"M\", selected=true) Metal\r\n                            option(value=\"P\") Plastic\r\n        hr\r\n        table(class=\"centered\")\r\n            tr\r\n                th \r\n                th OD / Right\r\n                th OS / Left\r\n            tr\r\n                th Sphere\r\n                td \r\n                    input#od_sphere(type=\"text\", name=\"od_sphere\", tabindex=\"6\")     \r\n                    div(id=\"debug\")\r\n                td \r\n                    input#os_sphere(type=\"text\", name=\"os_sphere\", tabindex=\"10\")\r\n            tr\r\n                th Cylinder\r\n                td \r\n                    input#od_cylinder(type=\"text\", name=\"od_cylinder\", tabindex=\"7\")\r\n                td \r\n                    input#os_cylinder(type=\"text\", name=\"os_cylinder\",tabindex=\"11\")\r\n            tr\r\n                th Axis\r\n                td \r\n                    input#od_axis(type=\"text\", name=\"od_axis\", tabindex=\"8\")\r\n                td \r\n                    input#os_axis(type=\"text\", name=\"os_axis\", tabindex=\"12\")\r\n            tr\r\n                th Add\r\n                td \r\n                    input#od_add(type=\"text\", name=\"od_add\", disabled=\"disabled\", tabindex=\"9\")\r\n                td \r\n                    input#os_add(type=\"text\", name=\"os_add\", disabled=\"disabled\", tabindex=\"13\")\r\n    \r\n        p.buttons\r\n            input(type=\"submit\", value=\"Save\", onclick=\"return validate()\", tabindex=\"14\") \r\n    \r\n\r\n\r\n"]],"start1":0,"start2":0,"length1":0,"length2":9034}]],"length":9034}
{"contributors":[],"silentsave":false,"ts":1359912988022,"patch":[[{"diffs":[[0,"    "],[-1,"l"],[0,"in"],[-1,"k(rel='stylesheet', href='/stylesheets/style.css')\r\n    script(src='/js/jquery-1.9.0.min.js')\r\n    script(src='/js/jquery.mask.min.js')"],[1,"clude includes/common_head  \r\n"],[0,"\r\n  "]],"start1":41,"start2":41,"length1":146,"length2":40},{"diffs":[[0,"9999.99');\r\n"],[1,"          applyUIStyle();    \r\n          \r\n"],[0,"          $("]],"start1":166,"start2":166,"length1":24,"length2":67},{"diffs":[[0,"ters($(this));\r\n"],[1,"                if($(\"#os_sphere\").val()==\"\")\r\n                    $(\"#os_sphere\").val($(\"#od_sphere\").val());\r\n"],[0,"            }); "]],"start1":892,"start2":892,"length1":32,"length2":144},{"diffs":[[0,"        });   \r\n"],[-1,""],[0,"        });\r\n\r\n "]],"start1":1296,"start2":1296,"length1":32,"length2":32},{"diffs":[[0,"  \r\n        });\r"],[1,"\n        \r\n        function applyUIStyle()\r\n        {\r\n            $(\"#od_sphere,#os_sphere,#od_cylinder,#os_cylinder,#od_axis,#os_axis\").parent().tooltip();\r\n        }\r"],[0,"\n\r\n        funct"]],"start1":1308,"start2":1308,"length1":32,"length2":201},{"diffs":[[0,"\r\nbody\r\n"],[1,"  include includes/menu  \r\n"],[0,"  h1 Inv"]],"start1":5560,"start2":5560,"length1":16,"length2":43}]],"length":9279,"saved":false}
{"ts":1359913010479,"patch":[[{"diffs":[[0,"gative\r\n"],[1,"                if($(\"#os_cylinder\").val()==\"\")\r\n                    $(\"#os_cylinder\").val($(\"#od_cylinder\").val());\r\n"],[0,"        "]],"start1":1284,"start2":1284,"length1":16,"length2":134}]],"length":9397,"saved":false}
{"ts":1359913062132,"patch":[[{"diffs":[[0,"rees($(this));\r\n"],[1,"                if($(\"#os_axis\").val()==\"\")\r\n                    $(\"#os_axis\").val($(\"#od_axis\").val());\r\n"],[0,"            });\r"]],"start1":777,"start2":777,"length1":32,"length2":138}]],"length":9503,"saved":false}
{"ts":1359913107331,"patch":[[{"diffs":[[0,"            }); "],[-1,"  "],[1,"\r\n\r\n            $(\"#od_add\").blur(function(){\r\n                if($(\"#os_add\").val()==\"\")\r\n                    $(\"#os_add\").val($(\"#od_add\").val());\r\n            });"],[0,"\r\n        });\r\n "]],"start1":1516,"start2":1516,"length1":34,"length2":197}]],"length":9666,"saved":false}
{"ts":1359913130552,"patch":[[{"diffs":[[0,"od_add\","],[-1," disabled=\"disabled\","],[0," tabinde"]],"start1":9374,"start2":9374,"length1":37,"length2":16},{"diffs":[[0,"dd\","],[-1," disabled=\"disabled\","],[0," tab"]],"start1":9475,"start2":9475,"length1":29,"length2":8}]],"length":9624,"saved":false}
{"ts":1359913144128,"patch":[[{"diffs":[[0," {\r\n"],[-1,"                    alert(\"Single\");\r\n"],[0,"    "]],"start1":320,"start2":320,"length1":46,"length2":8}]],"length":9586,"saved":false}
{"contributors":[],"silentsave":false,"ts":1360082836447,"patch":[[{"diffs":[[0,"led\",\"disabled\")"],[1,".val(\")"],[0,";\r\n             "]],"start1":368,"start2":368,"length1":32,"length2":39},{"diffs":[[0,"led\",\"disabled\")"],[1,".val(null)"],[0,";\r\n             "]],"start1":438,"start2":438,"length1":32,"length2":42}]],"length":9603,"saved":false}
{"ts":1360082839957,"patch":[[{"diffs":[[0,"\").val(\""],[1,"\""],[0,");\r\n    "]],"start1":382,"start2":382,"length1":16,"length2":17},{"diffs":[[0,"d\").val("],[-1,"null"],[1,"\"\""],[0,");\r\n    "]],"start1":452,"start2":452,"length1":20,"length2":18}]],"length":9602,"saved":false}
{"ts":1360082854704,"patch":[[{"diffs":[[0," Single "],[1,"Vision"],[0,"        "]],"start1":6644,"start2":6644,"length1":16,"length2":22}]],"length":9608,"saved":false}
{"contributors":[],"silentsave":false,"ts":1360127947656,"patch":[[{"diffs":[[0,"\n            }\r\n"],[1,"            \r\n            if(calc_val\r\n            \r\n"],[0,"            obj."]],"start1":2394,"start2":2394,"length1":32,"length2":85},{"diffs":[[0,"     }\r\n        "],[1,"\r\n        function paddy(n, p, c) {\r\n            var pad_char = typeof c !== 'undefined' ? c : '0';\r\n            var pad = new Array(1 + p).join(pad_char);\r\n            return (pad + n).slice(-pad.length);\r\n        }\r\n    "],[0,"    \r\n        fu"]],"start1":2550,"start2":2550,"length1":32,"length2":254}]],"length":9883,"saved":false}
{"ts":1360127988431,"patch":[[{"diffs":[[0,"            "],[-1,"if"],[1,"paddy"],[0,"(calc_val\r\n "]],"start1":2424,"start2":2424,"length1":26,"length2":29},{"diffs":[[0,"calc_val"],[1,", 3, '0');"],[0,"\r\n      "]],"start1":2442,"start2":2442,"length1":16,"length2":26}]],"length":9896,"saved":false}
{"ts":1360128003086,"patch":[[{"diffs":[[0,"        "],[1," calc_val ="],[0," paddy(c"]],"start1":2427,"start2":2427,"length1":16,"length2":27}]],"length":9907,"saved":false}
{"ts":1360128720671,"patch":[[{"diffs":[[0,"mon_head  \r\n"],[1,"    "],[0,"\r\n    script"]],"start1":65,"start2":65,"length1":24,"length2":28},{"diffs":[[0,"    "],[-1,"function paddy(n, p, c) {\r\n            var pad_char = typeof c !== 'undefined' ? c : '0';\r\n            var pad = new Array(1 + p).join(pad_char);\r\n            return (pad + n).slice(-pad.length);\r\n        }"],[0,"\r\n  "]],"start1":2600,"start2":2600,"length1":214,"length2":8}]],"length":9705,"saved":false}
{"ts":1360128737669,"patch":[[{"diffs":[[0,"    "],[-1,"/*\r\n            $(\"#debug\").html(null);\r\n            $(\"#debug\").html($(\"#debug\").html()+ \"<br>orig:\" + orig_val);\r\n            $(\"#debug\").html($(\"#debug\").html()+ \"<br>Math.abs:\" + val_abs);\r\n            $(\"#debug\").html($(\"#debug\").html()+ \"<br>Math.floor:\" + val_floor);\r\n            $(\"#debug\").html($(\"#debug\").html()+ \"<br>Abs-Floor:\" + val_dec);\r\n            $(\"#debug\").html($(\"#debug\").html()+ \"<br>Mod:\" + val_mod );\r\n            $(\"#debug\").html($(\"#debug\").html()+ \"<br>diff:\" + val_diff );\r\n            $(\"#debug\").html($(\"#debug\").html()+ \"<br>Calculated:\" + cal_val );\r\n            $(\"#debug\").html($(\"#debug\").html()+ \"<br>Calc Dec:\" + Math.abs(cal_val) +\"-\"+ Math.floor(cal_val) + \"=\" + dec);\r\n        */    "],[0,"\r\n  "]],"start1":4176,"start2":4176,"length1":734,"length2":8}]],"length":8979,"saved":false}
{"ts":1360128742567,"patch":[[{"diffs":[[0,"     }\r\n"],[-1,"              \r\n"],[0,"    \r\n  "]],"start1":4017,"start2":4017,"length1":32,"length2":16}]],"length":8963,"saved":false}
{"ts":1360128799421,"patch":[[{"diffs":[[0,"    "],[-1,"\r\n            \r\n            /*if(parseFloat(val_dec) == 0)\r\n            {\r\n                obj.val(val_floor + \".00\");\r\n                return;\r\n            }*/\r\n            \r\n            if(val_mod >= 0.13)"],[1,"if(val_mod >= 0.125) /* 0.25 / 2 = 0.125 */"],[0,"\r\n  "]],"start1":3322,"start2":3322,"length1":215,"length2":51}]],"length":8799,"saved":false}
{"ts":1360128812127,"patch":[[{"diffs":[[0,"      \r\n"],[-1,"        \r\n        \r\n"],[0,"        "]],"start1":2588,"start2":2588,"length1":36,"length2":16}]],"length":8779,"saved":false}
